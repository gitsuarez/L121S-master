<h1>Logged user - <?php  echo htmlspecialchars($user->name_support)?></h1><?php  if (isset($errors)) : ?><?php  if (isset($errors)) : ?><div data-alert class="alert alert-danger alert-dismissible fade in"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><ul class="validation-ul"><?php  foreach ($errors as $err) : ?><li><?php  echo $err?></li><?php  endforeach;?></ul></div><?php  endif;?><?php  endif; ?><?php  if (isset($account_updated) && $account_updated == 'done') : $msg = 'Account updated'; ?><div role="alert" class="alert alert-success alert-dismissible fade in"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><?php  echo $msg?></div><?php  endif; ?><?php  if (isset($account_updated_departaments) && $account_updated_departaments == 'done') : ?><?php  $msg = 'Account updated'; ?><div role="alert" class="alert alert-success alert-dismissible fade in"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><?php  echo $msg?></div><?php  endif; ?><ul class="nav nav-pills" role="tablist"><li role="presentation" <?php  if ($tab == '') : ?> class="active" <?php  endif;?>><a href="#account" aria-controls="account" role="tab" data-toggle="tab">Account data</a></li><?php  if (erLhcoreClassUser::instance()->hasAccessTo('lhuser','see_assigned_departments')) : ?><li role="presentation" <?php  if ($tab == 'tab_departments') : ?>class="active"<?php  endif;?>><a href="#departments" aria-controls="departments" role="tab" data-toggle="tab" >Assigned departments</a></li><?php  endif;?><?php  if (erLhcoreClassUser::instance()->hasAccessTo('lhuser','change_visibility_list')) : ?><li role="presentation" <?php  if ($tab == 'tab_settings') : ?>class="active"<?php  endif;?>><a href="#lists" aria-controls="lists" role="tab" data-toggle="tab">Visible lists</a></li><?php  endif; ?><?php  $user_menu_tabs_personal_canned_messages_tab = true;?><?php  if ($user_menu_tabs_personal_canned_messages_tab == true && erLhcoreClassUser::instance()->hasAccessTo('lhuser','personalcannedmsg')) : ?><li role="presentation" <?php  if ($tab == 'tab_canned') : ?>class="active"<?php  endif;?>><a href="#canned" aria-controls="canned" role="tab" data-toggle="tab">Personal canned messages</a></li><?php  endif;?><?php  if (erLhcoreClassUser::instance()->hasAccessTo('lhuser','allowtochoosependingmode')) : ?><li role="presentation" <?php  if ($tab == 'tab_pending') : ?>class="active"<?php  endif;?>><a href="#pending" aria-controls="pending" role="tab" data-toggle="tab">Pending chats</a></li><?php  endif;?><?php  if (erLhcoreClassUser::instance()->hasAccessTo('lhspeech','changedefaultlanguage')) : ?><li role="presentation" <?php  if ($tab == 'tab_speech') : ?>class="active"<?php  endif;?>><a href="#speech" aria-controls="speech" role="tab" data-toggle="tab">Speech</a></li><?php  endif;?><?php  if (erLhcoreClassUser::instance()->hasAccessTo('lhpermission','see_permissions')) : ?><li role="presentation" <?php  if ($tab == 'tab_permission') : ?>class="active"<?php  endif;?>><a href="#permission" aria-controls="permission" role="tab" data-toggle="tab">Permissions</a></li><?php  endif;?><li role="presentation" <?php  if ($tab == 'tab_notifications') : ?>class="active"<?php  endif;?>><a href="#notifications" aria-controls="notifications" role="tab" data-toggle="tab">Notifications</a></li><?php   ?></ul><div class="tab-content"><div role="tabpanel" class="tab-pane <?php  if ($tab == '') : ?>active<?php  endif;?>" id="account"><?php   ?><div class="explain">Do not enter a password unless you want to change it</div><br /><form action="/richard/sites/live121support.com-master/index.php/site_admin/user/account" method="post" autocomplete="off" enctype="multipart/form-data"><?php   ?><input type="hidden" name="csfr_token" value="<?php  echo erLhcoreClassUser::instance()->getCSFRToken()?>" /><div class="form-group"><label>Username</label><input type="text" class="form-control" placeholder="Your username" name="Username" value="<?php  echo htmlspecialchars($user->username);?>" /></div><div class="form-group"><label>Password</label><input autocomplete="new-password" type="password" class="form-control" placeholder="Enter a new password" name="Password" value="<?php  echo htmlspecialchars(isset($user->password_temp_1) ? $user->password_temp_1 : '');?>" /></div><div class="form-group"><label>Repeat password</label><input autocomplete="new-password" type="password" class="form-control" placeholder="Repeat the new password" name="Password1" value="<?php  echo htmlspecialchars(isset($user->password_temp_2) ? $user->password_temp_2 : '');?>" /></div><div class="form-group"><label>Email</label><input type="text" class="form-control" value="<?php  echo $user->email;?>" name="Email" placeholder="Your email address" id="email" class="required email valid"></div><div class="form-group"><label>Chat nickname</label><input type="text" class="form-control" name="ChatNickname" value="<?php  echo htmlspecialchars($user->chat_nickname);?>" /></div><div class="form-group"><label>Name</label><input type="text" class="form-control" name="Name" value="<?php  echo htmlspecialchars($user->name);?>" /></div><div class="form-group"><label>Surname</label><input type="text" class="form-control" name="Surname" value="<?php  echo htmlspecialchars($user->surname);?>" /></div><div class="form-group"><label>Job title</label><input type="text" class="form-control" name="JobTitle" value="<?php  echo htmlspecialchars($user->job_title);?>" /></div><div class="form-group"><label>User time zone</label><?php  $tzlist = DateTimeZone::listIdentifiers(DateTimeZone::ALL); ?><select name="UserTimeZone" class="form-control"><option value="">[[Application default time zone]]</option><?php  foreach ($tzlist as $zone) : ?><option value="<?php  echo htmlspecialchars($zone)?>" <?php  $user->time_zone == $zone ? print 'selected="selected"' : ''?>><?php  echo htmlspecialchars($zone)?></option><?php  endforeach;?></select></div><div class="row"><?php  if (erLhcoreClassUser::instance()->hasAccessTo('lhuser','changevisibility')) : ?><div class="col-xs-6"><div class="form-group"><label title="Chat status will not change upon pending chat opening"><input type="checkbox" value="on" name="UserInvisible" <?php  echo $user->invisible_mode == 1 ? 'checked="checked"' : '' ?> /> Invisible mode</label></div></div><?php  endif; ?><?php  if (erLhcoreClassUser::instance()->hasAccessTo('lhuser','receivepermissionrequest')) : ?><div class="col-xs-6"><div class="form-group"><label title="I receive other operators permissions request"><input type="checkbox" value="on" name="ReceivePermissionRequest" <?php  echo $user->rec_per_req == 1 ? 'checked="checked"' : '' ?> /> I receive other operators permissions request</label></div></div><?php  endif; ?></div><div class="form-group"><div class="row"><?php  if (erLhcoreClassUser::instance()->hasAccessTo('lhuser','changeskypenick')) : ?><div class="col-md-6"><label>Skype</label><input class="form-control" type="text" name="Skype" value="<?php  echo htmlspecialchars($user->skype);?>" /></div><?php  endif;?><div class="col-md-6"><label>XMPP username</label><input class="form-control" type="text" name="XMPPUsername" value="<?php  echo htmlspecialchars($user->xmpp_username);?>" /></div></div></div><div class="form-group"><label>Photo, (jpg,png)</label><input type="file" name="UserPhoto" value="" /><?php  if ($user->has_photo) : ?><div><img src="<?php  echo $user->photo_path?>" alt="" width="50" /><br /><label><input type="checkbox" name="DeletePhoto" value="1" /> Delete</label></div><?php  endif;?></div><?php   ?><div class="btn-group" role="group" aria-label="..."><input type="submit" name="Update" class="btn btn-primary" value="Update"><a class="btn btn-default" href="/richard/sites/live121support.com-master/index.php/site_admin/">Return</a></div></form></div><?php  if (erLhcoreClassUser::instance()->hasAccessTo('lhuser','see_assigned_departments')) : ?><div role="tabpanel" class="tab-pane <?php  if ($tab == 'tab_departments') : ?>active<?php  endif;?>" id="departments" ><?php   $userDepartaments = erLhcoreClassUserDep::getUserDepartamentsIndividual(); $userDepartamentsGroup = erLhcoreClassModelDepartamentGroupUser::getUserGroupsIds($user->id); ?><?php  if ($editdepartaments === true) { ?><form action="/richard/sites/live121support.com-master/index.php/site_admin/user/account#departments" method="post" enctype="multipart/form-data"><label><input type="checkbox" value="on" name="all_departments" <?php  echo $user->all_departments == 1 ? 'checked="checked"' : '' ?> />All departments</label><br><hr class="mt10 mb10"><div class="row"><div class="col-xs-6"><input type="hidden" name="csfr_token" value="<?php  echo erLhcoreClassUser::instance()->getCSFRToken()?>" /><h4>Individual departments</h4><div class="mx170"><?php  foreach (erLhcoreClassDepartament::getDepartaments() as $departament) : ?><label><input type="checkbox" name="UserDepartament[]" value="<?php  echo $departament['id']?>" <?php  echo in_array($departament['id'],$userDepartaments) ? 'checked="checked"' : '';?> /><?php  echo htmlspecialchars($departament['name'])?></label><br><?php  endforeach; ?></div></div><?php  $departmentsGroups = erLhcoreClassModelDepartamentGroup::getList(array('limit' => false)); ?><?php  if (!empty($departmentsGroups)) : ?><div class="col-xs-6"><h4>Departments groups</h4><?php  foreach ($departmentsGroups as $departamentGroup) : ?><label><input type="checkbox" name="UserDepartamentGroup[]" value="<?php  echo $departamentGroup->id?>" <?php  echo in_array($departamentGroup->id,$userDepartamentsGroup) ? ' checked="checked" ' : '';?> /><?php  echo htmlspecialchars($departamentGroup->name)?></label><br><?php  endforeach; ?></div><?php  endif;?></div><input type="submit" class="btn btn-default" name="UpdateDepartaments_account" value="Update" /></form><?php  } else {?><?php  foreach (erLhcoreClassDepartament::getDepartaments() as $departament) : ?><label><input type="checkbox" disabled value="<?php  echo $departament['id']?>" <?php  echo in_array($departament['id'],$userDepartaments) ? 'checked="checked"' : '';?> /><?php  echo htmlspecialchars($departament['name'])?></label><br><?php  endforeach; ?><?php  } ?></div><?php  endif;?><?php  if (erLhcoreClassUser::instance()->hasAccessTo('lhuser','change_visibility_list')) : ?><div role="tabpanel" class="tab-pane <?php  if ($tab == 'tab_settings') : ?>active<?php  endif;?>" id="lists"><form action="/richard/sites/live121support.com-master/index.php/site_admin/user/account" method="post"><input type="hidden" name="csfr_token" value="<?php  echo erLhcoreClassUser::instance()->getCSFRToken()?>" /><label><input type="checkbox" name="pendingTabEnabled" value="1" <?php  erLhcoreClassModelUserSetting::getSetting('enable_pending_list',1) == 1 ? print 'checked="checked"' : '' ?> /> Pending chats list enabled</label><br><label><input type="checkbox" name="activeTabEnabled" value="1" <?php  erLhcoreClassModelUserSetting::getSetting('enable_active_list',1) == 1 ? print 'checked="checked"' : '' ?> /> Active chats list enabled</label><br><label><input type="checkbox" name="unreadTabEnabled" value="1" <?php  erLhcoreClassModelUserSetting::getSetting('enable_unread_list',1) == 1 ? print 'checked="checked"' : '' ?> /> Unread chats list enabled</label><br><label><input type="checkbox" name="closedTabEnabled" value="1" <?php  erLhcoreClassModelUserSetting::getSetting('enable_close_list',0) == 1 ? print 'checked="checked"' : '' ?> /> Closed chats list enabled</label><br><label><input type="checkbox" name="mychatsTabEnabled" value="1" <?php  erLhcoreClassModelUserSetting::getSetting('enable_mchats_list',0) == 1 ? print 'checked="checked"' : '' ?> /> My pending and active chats list enabled</label><br><input type="submit" class="btn btn-default" name="UpdateTabsSettings_account" value="Update" /></form></div><?php  endif; ?><?php  $user_menu_tabs_content_personal_canned_messages_tab = true;?><?php  if ($user_menu_tabs_content_personal_canned_messages_tab == true && erLhcoreClassUser::instance()->hasAccessTo('lhuser','personalcannedmsg')) : ?><div role="tabpanel" class="tab-pane <?php  if ($tab == 'tab_canned') : ?>active<?php  endif;?>" id="canned"><?php   $pages = new lhPaginator(); $pages->serverURL = '/richard/sites/live121support.com-master/index.php/site_admin/user/account'.'/(tab)/canned'; $pages->items_total = erLhcoreClassModelCannedMsg::getCount(array('filter' => array('user_id' => $user->id))); $pages->setItemsPerPage(10); $pages->paginate(); $cannedMessages = array(); if ($pages->items_total > 0) { $cannedMessages = erLhcoreClassModelCannedMsg::getList(array('filter' => array('user_id' => $user->id),'offset' => $pages->low, 'limit' => $pages->items_per_page,'sort' => 'id ASC')); } ?><table class="table" cellpadding="0" cellspacing="0"><thead><tr><th width="1%">ID</th><th>Title/Message</th><th>Delay</th><th>Position</th><?php   ?><th width="1%">&nbsp;</th><th width="1%">&nbsp;</th></tr></thead><?php  foreach ($cannedMessages as $message) : ?><tr><td><?php  echo $message->id?></td><td><?php  echo nl2br(htmlspecialchars($message->title != '' ? $message->title : $message->msg))?></td><td><?php  echo $message->delay?></td><td><?php  echo $message->position?></td><?php   ?><td nowrap><a class="btn btn-default btn-xs" href="/richard/sites/live121support.com-master/index.php/site_admin/user/account/(msg)/<?php  echo $message->id?>/(tab)/canned">Edit message</a></td><td nowrap><a onclick="return confirm('Are you sure?')" class="csfr-required btn btn-danger btn-xs" href="/richard/sites/live121support.com-master/index.php/site_admin/user/account/(action)/delete/(tab)/canned/(msg)/<?php  echo $message->id?>">Delete message</a></td></tr><?php  endforeach; ?></table><script>lhinst.protectCSFR();</script><?php  if (isset($pages)) : ?><?php  if (isset($pages) && $pages->num_pages > 1) : ?><nav><ul class="pagination paginator-lhc"><?php  if ($pages->current_page != 1) : ?><li class="arrow"><a class="previous" href="<?php  echo $pages->serverURL,$pages->prev_page,$pages->querystring?>">&laquo;</a></li><?php  endif;?><?php  if ($pages->num_pages > 10) : $needNoBolder = false; if ($pages->range[0] > 1) : $i = 1; $pageURL = $i > 1 ? '/(page)/'.$i : ''; $needNoBolder = true; if ($i == $pages->current_page) : ?><li class="current no-b"><a title="Go to page <?php  echo $i?> of <?php  echo $pages->num_pages?>" href="#"><?php  echo $i?></a></li><?php  else : ?><li><a class="no-b" title="Go to page <?php  echo $i?> of <?php  echo $pages->num_pages?>" href="<?php  echo $pages->serverURL,$pageURL,$pages->querystring?>"><?php  echo $i?></a></li><?php  endif; ?><li><a href="#">...</a></li><?php endif; for($i=$pages->range[0];$i<=$pages->lastArrayNumber;$i++) : if ($i > 0) : $pageURL = $i > 1 ? '/(page)/'.$i : ''; $noBolderClass = ($i == 1 || $needNoBolder == true) ? ' no-b' : ''; $needNoBolder = false; if ($i == $pages->current_page): ?><li class="active<?php  echo $noBolderClass?>"><a title="Go to page <?php  echo $i?> of <?php  echo $pages->num_pages?>"  href="#"><?php  echo $i?></a></li><?php  else : ?><li><a class="<?php  echo $noBolderClass?>" title="Go to page <?php  echo $i?> of <?php  echo $pages->num_pages?>" href="<?php  echo $pages->serverURL,$pageURL,$pages->querystring?>"><?php  echo $i?></a></li><?php  endif;endif;endfor; if ($pages->lastArrayNumber < $pages->num_pages) : $i = $pages->num_pages; $pageURL = $i > 1 ? '/(page)/'.$i : ''; ?><li><a href="#">...</a></li><?php  if ($i == $pages->current_page) : ?><li class="active"><a title="Go to page <?php  echo $i?> of <?php  echo $pages->num_pages?>" href="#"><?php  echo $i?></a></li><?php   else : ?><li><a class="no-b" title="Go to page <?php  echo $i?> of <?php  echo $pages->num_pages?>" href="<?php  echo $pages->serverURL,$pageURL,$pages->querystring?>"><?php  echo $i?></a></li><?php  endif; endif; else : for ($i=1;$i<=$pages->num_pages;$i++) : $noBolderClass = ($i == 1) ? ' no-b' : ''; $pageURL = $i > 1 ? '/(page)/'.$i : ''; if ($i == $pages->current_page) :?><li class="active<?php  echo $noBolderClass?>"><a href="#"><?php  echo $i?></a></li><?php  else : ?><li><a class="paginate" href="<?php  echo $pages->serverURL,$pageURL,$pages->querystring;?>"><?php  echo $i?></a></li><?php  endif; endfor; endif; if ($pages->current_page != $pages->num_pages): ?><li class="arrow"><a class="next" href="<?php  echo $pages->serverURL,'/(page)/',$pages->next_page,$pages->querystring?>">&raquo;</a></li><?php  endif;?></ul><div class="found-total pull-right">Page <?php  echo $pages->current_page?> of <?php  echo $pages->num_pages?>, Found - <?php  echo $pages->items_total?></div></nav><?php  endif;?><?php  endif;?><hr><h3>Personal canned message</h3><?php  if (isset($errors_canned)) : $errors = $errors_canned; ?><?php  if (isset($errors)) : ?><div data-alert class="alert alert-danger alert-dismissible fade in"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><ul class="validation-ul"><?php  foreach ($errors as $err) : ?><li><?php  echo $err?></li><?php  endforeach;?></ul></div><?php  endif;?><?php  endif; ?><?php  if (isset($updated_canned)) : ?><?php  $msg = 'Canned message was saved'; ?><div role="alert" class="alert alert-success alert-dismissible fade in"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><?php  echo $msg?></div><?php  endif; ?><form action="<?php  if ($canned_msg->id > 0) : ?>/richard/sites/live121support.com-master/index.php/site_admin/user/account/(msg)/<?php  echo $canned_msg->id?><?php  endif;?>#canned" method="post"><div class="form-group"><label>Title</label><input type="text" class="form-control" name="Title" value="<?php  echo htmlspecialchars($canned_msg->title);?>" /></div><div class="form-group"><label>Explain</label><input type="text" class="form-control" name="ExplainHover" value="<?php  echo htmlspecialchars($canned_msg->explain);?>" /></div><div class="form-group"><label><?php  echo erTranslationClassLhTranslation::getInstance()->getTranslation("chat/cannedmsg","Tag's");?></label><input type="text" class="form-control" name="Tags" value="<?php  echo htmlspecialchars($canned_msg->tags_plain)?>" /></div><div class="form-group"><label>Message</label><textarea class="form-control" name="Message"><?php  echo htmlspecialchars($canned_msg->msg);?></textarea></div><div class="form-group"><label>Fallback message</label><textarea class="form-control" name="FallbackMessage"><?php  echo htmlspecialchars($canned_msg->fallback_msg);?></textarea></div><div class="form-group"><label><input type="checkbox" name="AutoSend" value="on" <?php  $canned_msg->auto_send == 1 ? print 'checked="checked"' : ''?> /> Automatically send this message to user then chat is accepted</label></div><div class="form-group"><label>Delay in seconds</label><input type="text" class="form-control" name="Delay" value="<?php  echo $canned_msg->delay?>" /></div><div class="form-group"><label>Position</label><input type="text" class="form-control" name="Position" value="<?php  echo $canned_msg->position?>" /></div><?php   ?><div class="btn-group" role="group" aria-label="..."><input type="submit" class="btn btn-default" name="Save_canned_action" value="Save"/><?php  if ($canned_msg->id > 0) : ?><input type="submit" class="btn btn-default" name="Cancel_canned_action" value="Cancel"/><?php  endif;?></div></form></div><?php  endif;?><?php  if (erLhcoreClassUser::instance()->hasAccessTo('lhuser','allowtochoosependingmode')) : ?><div role="tabpanel" class="tab-pane <?php  if ($tab == 'tab_pending') : ?>active<?php  endif;?>" id="pending"><form action="/richard/sites/live121support.com-master/index.php/site_admin/user/account" method="post"><input type="hidden" name="csfr_token" value="<?php  echo erLhcoreClassUser::instance()->getCSFRToken()?>" /><div class="form-group"><label><input type="checkbox" name="showAllPendingEnabled" value="1" <?php  erLhcoreClassModelUserSetting::getSetting('show_all_pending',1) == 1 ? print 'checked="checked"' : '' ?> /> I can see all pending chats, not only assigned to me</label></div><input type="submit" class="btn btn-default" name="UpdatePending_account" value="Update" /></form></div><?php  endif; ?><?php  if (erLhcoreClassUser::instance()->hasAccessTo('lhspeech','changedefaultlanguage')) : ?><div role="tabpanel" class="tab-pane <?php  if ($tab == 'tab_speech') : ?>active<?php  endif;?>" id="speech"><form action="/richard/sites/live121support.com-master/index.php/site_admin/user/account" method="post"><input type="hidden" name="csfr_token" value="<?php  echo erLhcoreClassUser::instance()->getCSFRToken()?>" /><?php  $dataSpeech = array( 'language' => (int)erLhcoreClassModelUserSetting::getSetting('speech_language',''), 'dialect' => (int)erLhcoreClassModelUserSetting::getSetting('speech_dialect',''), 'optional' => true, ); ?><div class="row"><div class="col-md-6"><div class="form-group"><label>Language</label><?php   $params = array( 'input_name' => 'select_language', 'on_change' => "lhc.methodCall('lhc.speak','getDialect',$(this))", 'selected_id' => $dataSpeech['language'], 'css_class' => 'form-control', 'list_function' => 'erLhcoreClassModelSpeechLanguage::getList' ); if (isset($dataSpeech['optional'])){ $params['optional_field'] = 'Use application default recognition language'; }; echo erLhcoreClassRenderHelper::renderCombobox($params); ?></div></div><div class="col-md-6"><div class="form-group"><label>Dialect</label><?php   $params = array( 'input_name' => 'select_dialect', 'attr_id' => 'lang_code', 'css_class' => 'form-control', 'display_name' => 'dialect_name', 'selected_id' => $dataSpeech['dialect'], 'list_function' => 'erLhcoreClassModelSpeechLanguageDialect::getList', 'list_function_params' => array('filter' => array('language_id' => $dataSpeech['language'])) ); if (isset($dataSpeech['optional'])){ $params['optional_field'] = 'Use application default recognition dialect'; }; echo erLhcoreClassRenderHelper::renderCombobox($params); ?></div></div></div><input type="submit" class="btn btn-default" name="UpdateSpeech_account" value="Update" /></form></div><?php  endif; ?><?php  if (erLhcoreClassUser::instance()->hasAccessTo('lhpermission','see_permissions')) : ?><div role="tabpanel" class="tab-pane <?php  if ($tab == 'tab_permission') : ?>active<?php  endif;?>" id="permission"><input type="button" class="btn btn-default" name="UpdateSpeech_account" onclick="lhinst.showMyPermissions('<?php  echo $user->id?>')" value="Show permissions" /><div id="permissions-summary"></div></div><?php  endif;?><div role="tabpanel" class="tab-pane <?php  if ($tab == 'tab_notifications') : ?>active<?php  endif;?>" id="notifications"><div class="form-group"><div class="pull-left"><?php $soundData = erLhcoreClassModelChatConfig::fetch('sync_sound_settings')->data; $soundMessageEnabled = erLhcoreClassModelUserSetting::getSetting('chat_message',(int)($soundData['new_message_sound_admin_enabled'])); $soundNewChatEnabled = erLhcoreClassModelUserSetting::getSetting('new_chat_sound',(int)($soundData['new_chat_sound_enabled'])); $canChangeOnlineStatus = false; $currentUser = erLhcoreClassUser::instance(); if ( $currentUser->hasAccessTo('lhuser','changeonlinestatus') ) { $canChangeOnlineStatus = true; if ( !isset($UserData) ) { $UserData = $currentUser->getUserData(true); } } $canChangeVisibilityMode = false; if ( $currentUser->hasAccessTo('lhuser','changevisibility') ) { $canChangeVisibilityMode = true; if ( !isset($UserData) ) { $UserData = $currentUser->getUserData(true); } } ?><?php  if ($currentUser->hasAccessTo('lhchat','use') ) : ?><?php  if (!isset($hideULSetting)) : ?><ul class="list-inline user-settings-list pull-right"><?php  endif;?><li><a href="#"><i class="material-icons" onclick="return lhinst.disableChatSoundAdmin($(this))" title="Enable/Disable sound about new messages from users"><?php  $soundMessageEnabled == 0 ? print 'volume_off' : print 'volume_up'?></i></a></li><li><a href="#"><i class="material-icons" onclick="return lhinst.disableNewChatSoundAdmin($(this))" title="Enable/Disable sound about new pending chats"><?php  $soundNewChatEnabled == 0 ? print 'volume_off' : print 'volume_up'?></i></a></li><?php  if ($canChangeVisibilityMode == true) : ?><li><a href="#"><i id="vi-in-user" class="material-icons" title="Change my visibility to visible/invisible" onclick="return lhinst.changeVisibility($(this))"><?php  $UserData->invisible_mode == 1 ? print 'visibility_off' : print 'visibility'?></i><span class="menu-status-txt" id="visibility" onclick="return lhinst.changeVisibility($('#vi-in-user'))"><?php  $UserData->invisible_mode == 1 ? print 'invisible' : print 'visible'?></span></a></li><?php  endif;?><?php  if ($canChangeOnlineStatus == true) : ?><li><a href="#"><i id="online-offline-user" class="material-icons" title="Change my status to online/offline" onclick="return lhinst.disableUserAsOnline($(this))"><?php  $UserData->hide_online == 1 ? print 'flash_off' : print 'flash_on'?></i><span class="menu-status-txt" id="online-status" onclick="return lhinst.disableUserAsOnline($('#online-offline-user'))"><?php  $UserData->hide_online == 1 ? print 'offline' : print 'online'?></span></a></li><?php  endif;?><?php  if (!isset($hideULSetting)) : ?></ul><?php  endif;?><?php  endif;?></div><br/><br/><form action="/richard/sites/live121support.com-master/index.php/site_admin/user/account#notifications" method="post" enctype="multipart/form-data"><input type="hidden" name="csfr_token" value="<?php  echo erLhcoreClassUser::instance()->getCSFRToken()?>" /><div class="form-group"><input type="button" class="btn btn-primary" value="Request notification permission" onclick="lhinst.requestNotificationPermission()" /></div><div class="row"><div class="col-xs-6"><div class="form-group"><label><input type="checkbox" name="ownntfonly" value="on" <?php  erLhcoreClassModelUserSetting::getSetting('ownntfonly',0) == 1 ? print 'checked="checked"' : '' ?>> Show notification only if I am an owner pending chat</label><br/><small><i>You will stop receive notifications for pending chats if you are not an owner</i></small></div><div class="form-group"><label><input type="checkbox" name="sn_off" value="on" <?php  erLhcoreClassModelUserSetting::getSetting('sn_off',1) == 1 ? print 'checked="checked"' : '' ?>> Show notifications if I am offline</label><br/><small><i>You will not receive notifications if you are not online</i></small></div><div class="form-group"><label><input type="checkbox" name="show_alert_chat" value="on" <?php  erLhcoreClassModelUserSetting::getSetting('show_alert_chat',0) == 1 ? print 'checked="checked"' : '' ?>> Show alert for new chats</label></div></div><div class="col-xs-6"><?php  if ((int)erLhcoreClassModelChatConfig::fetchCache('activity_track_all')->current_value == 1) : ?><div class="alert alert-warning">Activity tracking is set at global level. Your settings will be be ignored. Timeout value still will be taken from your account settings.</div><?php  endif; ?><div class="form-group"><label><input type="checkbox" name="trackactivity" value="on" <?php  erLhcoreClassModelUserSetting::getSetting('trackactivity',0) == 1 ? print 'checked="checked"' : '' ?>> Change my online/offline status based on my activity</label><br/><small><i>After certain period of time if no actions are detected you will be marked as offline automatically</i></small></div><div class="form-group"><label>Choose timeout value</label><br/><small><i>Select after how long of inactivity you will be marked as offline automatically</i></small><select class="form-control" name="trackactivitytimeout"><option value="-1" <?php  echo erLhcoreClassModelUserSetting::getSetting('trackactivitytimeout',-1) == -1 ? 'selected="selected"' : ''?>>Use default system value (<?php  echo (int)erLhcoreClassModelChatConfig::fetchCache('activity_timeout')->current_value?> minutes)</option><option value="300" <?php  echo erLhcoreClassModelUserSetting::getSetting('trackactivitytimeout',-1) == 300 ? 'selected="selected"' : ''?>>5 minutes</option><option value="600" <?php  echo erLhcoreClassModelUserSetting::getSetting('trackactivitytimeout',-1) == 600 ? 'selected="selected"' : ''?>>10 minutes</option><option value="1800" <?php  echo erLhcoreClassModelUserSetting::getSetting('trackactivitytimeout',-1) == 1800 ? 'selected="selected"' : ''?>>30 minutes</option></select></div></div></div><input type="submit" class="btn btn-default" name="UpdateNotifications_account" value="Update" /></form></div></div><?php   ?></div>